pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
global=_ENV
some_global_var=0

class=setmetatable({
	kind="class",
	set=function(_ENV,target)
		target=target or "default"
		kind=target
	end,
	draw=function(_ENV)
		line(0,0,16,16)
		global.some_global_var=rnd(10)
	end,
	report=function(self)
		print(self.kind)
	end,
	new=function(self,tbl)
		tbl=tbl or {}
		tbl.other="weird"
		setmetatable(tbl,{
			__index=self
		})
		return tbl
	end
},{__index=_ENV})

star=class:new({
	x=32,y=32,
	new=function(self,tbl)
		tbl=class.new(self,tbl)
		tbl.kind="star"
		return tbl
	end
})

a=star:new()
a:set(2)
a:report()

c=rnd({star,class}):new()
print("___")
c:report()
print("___")
c:draw()
print(c.other)
print(some_global_var)

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
